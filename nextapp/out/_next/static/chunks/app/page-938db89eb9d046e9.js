(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{138:(e,t,s)=>{Promise.resolve().then(s.bind(s,473))},473:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>k});var a=s(5155),l=s(2115),n=s(2619),i=s.n(n),r=s(6991),o=s(19),c=s(7734),d=s(3697),m=s(232),p=s(9585),x=s(2723),u=s(4035),h=s(9386),b=s(3581),g=s(2708);let f={Lesesäle:{gradient:"from-sky-400 via-sky-500 to-sky-600",accent:"text-sky-600",pieFill:"#0ea5e9"},Gruppenräume:{gradient:"from-amber-400 via-orange-400 to-orange-500",accent:"text-orange-500",pieFill:"#f97316"},Seitenbänke:{gradient:"from-emerald-400 via-teal-400 to-teal-500",accent:"text-emerald-500",pieFill:"#10b981"}},y={Lesesäle:{today:.68,tomorrow:.54},Gruppenräume:{today:.58,tomorrow:.48},Seitenbänke:{today:.5,tomorrow:.36}},j=["live","today","tomorrow"],v={live:"Live",today:"Heute",tomorrow:"Morgen"},w=e=>{let[t,s]=e.split(":").map(Number);return 60*t+s},N=e=>new Date(e).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"});function k(){let{bookings:e}=(0,g.dp)(),[t,s]=(0,l.useState)({}),n=Object.entries(b.L.reduce((e,t)=>(e[t.type]||(e[t.type]=[]),e[t.type].push(t),e),{})),[k,L]=(0,l.useState)(null),[M,S]=(0,l.useState)([]),D=(0,l.useMemo)(()=>"number"==typeof k&&Number.isFinite(k)?k:null,[k]),A=(0,l.useMemo)(()=>b.L.reduce((e,t)=>e+t.capacity,0),[]),F=(0,l.useMemo)(()=>null===D?null:Math.max(A-D,0),[A,D]),G=(0,l.useMemo)(()=>A&&null!==D?Math.round(D/A*100):null,[A,D]);(0,l.useEffect)(()=>{let e=new AbortController,t="https://api.beckya.de".replace(/\/$/,"");async function s(){try{let s=await fetch("".concat(t,"/api/occupancy"),{signal:e.signal});if(!s.ok)throw Error("Request failed with status ".concat(s.status));let a=await s.json();"number"==typeof a.currentPersons?L(a.currentPersons):"number"==typeof a.averagePersons&&L(Math.round(a.averagePersons)),Array.isArray(a.history)?S(a.history):S([])}catch(e){"AbortError"!==e.name&&console.error("Fehler beim Laden der Auslastung:",e)}}t||(t=window.location.origin.replace(/\/$/,"")),t=t||"http://localhost:5000",s();let a=setInterval(s,5e3);return()=>{e.abort(),clearInterval(a)}},[]);let P=(0,l.useMemo)(()=>{let t=new Date;return e.filter(e=>new Date(e.endDateTime)>=t).map(e=>({...e,start:N(e.startDateTime),end:N(e.endDateTime)}))},[e]),E=(0,l.useMemo)(()=>[...P].sort((e,t)=>w(e.start)-w(t.start)),[P]),C=E[0],I=E.slice(1),O=!!C,T=(0,l.useMemo)(()=>C?new Date(C.startDateTime).toLocaleDateString("de-DE",{weekday:"long",day:"numeric",month:"long"}):"",[C]),z=n.reduce((e,t)=>{let[s,a]=t,l=a.reduce((e,t)=>(e.people+=t.people,e.capacity+=t.capacity,e),{people:0,capacity:0});return e[s]=l,e},{}),B=(0,l.useMemo)(()=>M.length?M.slice(-10).map(e=>{let t=new Date(e.timestamp);return{...e,timeLabel:t.toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"}),dateLabel:t.toLocaleDateString("de-DE",{weekday:"short",day:"2-digit",month:"2-digit"})}}):[],[M]),K=(0,l.useMemo)(()=>[...B].reverse(),[B]),R=(0,l.useMemo)(()=>B.map(e=>({name:e.timeLabel,persons:e.persons})),[B]);return(0,a.jsxs)("div",{className:"mx-auto flex w-full max-w-5xl flex-col gap-10 pb-6 sm:gap-12",children:[(0,a.jsxs)("section",{className:"space-y-4 sm:space-y-6",children:[(0,a.jsx)("div",{className:"rounded-4xl bg-gradient-to-br from-sky-100 via-sky-50 to-white p-6 shadow-sm ring-1 ring-sky-100 sm:p-8",children:O?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-col gap-6 sm:flex-row sm:items-center sm:justify-between",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("span",{className:"inline-flex items-center gap-2 rounded-full bg-white/70 px-3 py-1 text-xs font-semibold uppercase tracking-wide text-sky-700",children:"Meine n\xe4chste Buchung"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-slate-900 sm:text-3xl",children:C.roomName}),(0,a.jsxs)("p",{className:"mt-1 text-sm text-slate-600",children:[C.start," – ",C.end," Uhr \xb7 ",C.category]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-3 text-xs text-slate-500",children:[(0,a.jsxs)("span",{className:"rounded-full bg-sky-200/50 px-3 py-1 font-medium text-sky-700",children:["Status: ",C.status]}),(0,a.jsx)("span",{className:"rounded-full bg-white px-3 py-1 font-medium text-slate-700",children:T})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-3 text-sm text-slate-600",children:[(0,a.jsxs)(i(),{href:"/bookings",className:"inline-flex items-center justify-center gap-2 rounded-full bg-sky-500 px-4 py-2 font-semibold text-white shadow-sm transition hover:bg-sky-600",children:["Buchung verwalten",(0,a.jsx)("span",{"aria-hidden":"true",children:"→"})]}),(0,a.jsx)(i(),{href:"/bookings/new",className:"inline-flex items-center justify-center gap-2 rounded-full border border-slate-200 bg-white px-4 py-2 font-semibold text-slate-700 shadow-sm transition hover:border-sky-200 hover:text-sky-700",children:"Neuen Raum suchen"})]})]}),I.length>0&&(0,a.jsx)("div",{className:"mt-6 grid gap-3 sm:grid-cols-2",children:I.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-3xl border border-slate-200 bg-white/70 px-4 py-3 text-sm text-slate-600 shadow-inner",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:e.roomName}),(0,a.jsxs)("p",{className:"text-xs uppercase tracking-wide text-slate-500",children:[e.start," – ",e.end," Uhr \xb7 ",e.category]})]}),(0,a.jsx)("span",{className:"rounded-full bg-slate-100 px-3 py-1 text-xs font-semibold text-slate-600",children:e.status})]},e.id))})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4 text-center text-slate-600",children:[(0,a.jsx)("span",{className:"inline-flex items-center gap-2 rounded-full bg-white/70 px-3 py-1 text-xs font-semibold uppercase tracking-wide text-sky-700",children:"Keine offenen Buchungen"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-slate-900 sm:text-2xl",children:"Starte deine erste Reservierung"}),(0,a.jsx)("p",{className:"max-w-md text-sm",children:"Aktuell sind keine Buchungen geplant. Du kannst jederzeit einen Raum ausw\xe4hlen und eine Anfrage anlegen."}),(0,a.jsxs)(i(),{href:"/bookings/new",className:"inline-flex items-center gap-2 rounded-full bg-sky-500 px-4 py-2 font-semibold text-white shadow-sm transition hover:bg-sky-600",children:["Jetzt unverbindlich buchen",(0,a.jsx)("span",{"aria-hidden":"true",children:"→"})]})]})}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-3 text-sm text-slate-600 sm:grid-cols-3",children:[{label:"Aktive R\xe4ume",value:b.L.length},{label:"Personen aktuell",value:D},{label:"Freie Pl\xe4tze",value:F},{label:"\xd8 Auslastung",value:G,suffix:"%"}].map(e=>{var t;let s=null===e.value||void 0===e.value?"–":"".concat(e.value).concat(null!=(t=e.suffix)?t:"");return(0,a.jsxs)("div",{className:"rounded-3xl border border-slate-200 bg-white px-5 py-4 shadow-sm",children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:e.label}),(0,a.jsx)("p",{className:"mt-3 text-2xl font-semibold text-slate-900",children:s})]},e.label)})}),(0,a.jsxs)("div",{className:"rounded-3xl border border-slate-200 bg-white px-5 py-4 shadow-sm",children:[(0,a.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Historie \xb7 Personen aktuell"}),(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"Letzte Messpunkte aus dem Live-Z\xe4hler."})]}),(0,a.jsxs)("span",{className:"text-xs font-semibold uppercase tracking-wide text-slate-400",children:[K.length," Eintr\xe4ge"]})]}),K.length>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"mb-6 w-full overflow-hidden rounded-2xl border border-slate-100 bg-slate-50/60 p-3",children:(0,a.jsx)(r.u,{width:"100%",height:220,children:(0,a.jsxs)(o.b,{data:R,margin:{top:10,right:20,left:0,bottom:0},children:[(0,a.jsx)(c.W,{dataKey:"name",tick:{fontSize:12},stroke:"#94a3b8"}),(0,a.jsx)(d.h,{allowDecimals:!1,width:30,stroke:"#94a3b8"}),(0,a.jsx)(m.m,{labelFormatter:e=>"Zeit: ".concat(e),formatter:e=>["".concat(e," Personen"),"Live-Wert"]}),(0,a.jsx)(p.N,{type:"monotone",dataKey:"persons",stroke:"#0ea5e9",strokeWidth:3,dot:{r:4}})]})})}),(0,a.jsx)("div",{className:"grid gap-2 text-sm text-slate-600 sm:grid-cols-2",children:K.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-2xl border border-slate-100 bg-slate-50/60 px-4 py-2",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsxs)("span",{className:"text-xs uppercase tracking-wide text-slate-400",children:[e.timeLabel," Uhr"]}),(0,a.jsx)("span",{className:"text-sm font-semibold text-slate-900",children:e.dateLabel})]}),(0,a.jsx)("span",{className:"text-xl font-semibold text-slate-900",children:e.persons})]},"".concat(e.timestamp,"-").concat(e.persons)))})]}):(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"Noch keine historischen Messwerte erhalten."})]})]}),(0,a.jsx)("section",{className:"space-y-8",children:n.map(e=>{var l,n,o,c;let[d,m]=e,p=z[d],b=null!=(n=f[d])?n:{gradient:"from-slate-400 via-slate-500 to-slate-600",accent:"text-slate-600",pieFill:"#64748b"},g=null!=(o=t[d])?o:"live",w=null!=(c=null==(l=y[d])?void 0:l[g])?c:.6,N=Math.min("live"===g?p.people:Math.round(p.capacity*w),p.capacity),k=Math.max(p.capacity-N,0),L=p.capacity?Math.round(N/p.capacity*100):0,M=[{name:"Belegt",value:N},{name:"Frei",value:k}];return(0,a.jsxs)("article",{className:"rounded-4xl border border-slate-200 bg-white/90 p-6 shadow-sm backdrop-blur sm:p-8",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-6 sm:flex-row sm:items-center sm:justify-between",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"inline-flex items-center gap-2 rounded-full bg-gradient-to-r ".concat(b.gradient," px-4 py-1 text-xs font-semibold uppercase tracking-wide text-white shadow"),children:d}),(0,a.jsxs)("span",{className:"text-xs font-medium uppercase tracking-wide text-slate-500",children:[m.length," R\xe4ume"]})]}),(0,a.jsxs)("p",{className:"text-sm text-slate-600",children:["Aggregierte Auslastung aller ",d," im \xdcberblick."]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-4 text-xs text-slate-500",children:[(0,a.jsxs)("span",{children:["Belegt: ",(0,a.jsx)("span",{className:"font-semibold text-slate-900",children:N})]}),(0,a.jsxs)("span",{children:["Kapazit\xe4t: ",(0,a.jsx)("span",{className:"font-semibold text-slate-900",children:p.capacity})]}),(0,a.jsxs)("span",{children:["Frei: ",(0,a.jsx)("span",{className:"font-semibold text-slate-900",children:k})]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4 sm:flex-row",children:[(0,a.jsx)("div",{className:"flex items-center gap-2 rounded-full border border-slate-200 bg-white px-2 py-1 text-xs font-semibold text-slate-600",children:j.map(e=>{let t=g===e;return(0,a.jsx)("button",{type:"button",onClick:()=>s(t=>({...t,[d]:e})),className:"rounded-full px-2.5 py-1 transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-sky-500 ".concat(t?"bg-sky-500 text-white shadow-sm":"text-slate-500 hover:text-slate-700"),"aria-pressed":t,children:v[e]},e)})}),(0,a.jsxs)("div",{className:"relative h-28 w-28",children:[(0,a.jsx)(r.u,{width:"100%",height:"100%",children:(0,a.jsx)(x.r,{children:(0,a.jsx)(u.F,{data:M,dataKey:"value",innerRadius:40,outerRadius:56,startAngle:90,endAngle:450,children:M.map((e,t)=>(0,a.jsx)(h.f,{fill:0===t?b.pieFill:"#e2e8f0"},"".concat(d,"-pie-").concat(e.name)))})})}),(0,a.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-center",children:[(0,a.jsx)("span",{className:"text-xs text-slate-500",children:"Auslastung"}),(0,a.jsxs)("span",{className:"text-lg font-semibold text-slate-900",children:[L,"%"]})]})]})]})]}),(0,a.jsx)("div",{className:"-mx-5 mt-6 overflow-x-auto pb-4",children:(0,a.jsx)("div",{className:"flex gap-4 px-1 sm:px-5",children:m.map(e=>{let t=e.people/e.capacity,s=0===t?{label:"Leer",badge:"bg-slate-200 text-slate-800"}:t<=1/3?{label:"Gering",badge:"bg-emerald-500 text-white"}:t<=2/3?{label:"Mittel",badge:"bg-amber-400 text-slate-900"}:t<1?{label:"Hoch",badge:"bg-orange-500 text-white"}:{label:"Voll",badge:"bg-rose-500 text-white"},l=Math.round(e.people/e.capacity*100);return(0,a.jsxs)(i(),{href:"/rooms/".concat(e.id),className:"group flex min-w-[240px] snap-start flex-col gap-4 rounded-3xl border border-slate-200 bg-gradient-to-br from-white via-white to-slate-50 p-5 shadow-sm transition hover:-translate-y-1 hover:shadow-lg focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-sky-400",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:e.type}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-slate-900",children:e.name})]}),(0,a.jsx)("span",{className:"rounded-full px-3 py-1 text-xs font-semibold ".concat(s.badge),children:s.label})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-xs text-slate-500",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:"Personen"}),(0,a.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:e.people})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:"Kapazit\xe4t"}),(0,a.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:e.capacity})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:"Auslastung"}),(0,a.jsxs)("p",{className:"text-sm font-semibold text-slate-900",children:[l,"%"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:"Freie Pl\xe4tze"}),(0,a.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:Math.max(e.capacity-e.people,0)})]})]}),(0,a.jsx)("div",{className:"h-2 w-full overflow-hidden rounded-full bg-slate-200",children:(0,a.jsx)("div",{className:"h-full rounded-full bg-gradient-to-r ".concat(b.gradient),style:{width:"".concat(Math.min(l,100),"%")},"aria-hidden":"true"})}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs font-semibold text-sky-600",children:[(0,a.jsxs)("span",{className:"flex items-center gap-2",children:["Details ansehen",(0,a.jsx)("span",{"aria-hidden":"true",className:"transition-transform group-hover:translate-x-1",children:"→"})]}),(0,a.jsx)("span",{className:"text-slate-500",children:v[g]})]})]},e.id)})})})]},d)})})]})}},2708:(e,t,s)=>{"use strict";s.d(t,{dp:()=>c,lK:()=>o});var a=s(5155),l=s(2115);let n=(0,l.createContext)(null),i=[7,3,11],r=()=>[{id:1,roomId:7,roomName:"Gruppenraum B",category:"Gruppenr\xe4ume",dayOffset:0,hour:13,minute:30,durationMinutes:90,status:"Best\xe4tigt",notes:"Projektbesprechung mit dem Tutorium."},{id:2,roomId:3,roomName:"Lesesaal 3",category:"Leses\xe4le",dayOffset:1,hour:9,minute:0,durationMinutes:120,status:"Option",notes:"Pr\xfcfungsvorbereitung Informatik."},{id:3,roomId:11,roomName:"Seitenbank 1",category:"Seitenb\xe4nke",dayOffset:-1,hour:18,minute:0,durationMinutes:60,status:"Abgeschlossen",notes:"Konzentrationsphase vor dem Vortrag."}].map(e=>{let t=new Date;t.setHours(0,0,0,0),t.setDate(t.getDate()+e.dayOffset),t.setHours(e.hour,e.minute,0,0);let s=new Date(t.getTime()+60*e.durationMinutes*1e3);return{id:e.id,roomId:e.roomId,roomName:e.roomName,category:e.category,startDateTime:t.toISOString(),endDateTime:s.toISOString(),status:e.status,notes:e.notes}});function o(e){let{children:t}=e,[s,o]=(0,l.useState)(i),[c,d]=(0,l.useState)(r),m=(0,l.useCallback)(e=>{o(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},[]),p=(0,l.useCallback)(e=>{d(t=>t.filter(t=>t.id!==e))},[]),x=(0,l.useMemo)(()=>({favorites:s,toggleFavorite:m,bookings:c,setBookings:d,cancelBooking:p}),[s,m,c,d,p]);return(0,a.jsx)(n.Provider,{value:x,children:t})}function c(){let e=(0,l.useContext)(n);if(!e)throw Error("useAppData must be used within an AppDataContext provider");return e}},3581:(e,t,s)=>{"use strict";s.d(t,{L:()=>a});let a=[{id:1,name:"Lesesaal 1",people:5,capacity:50,type:"Leses\xe4le"},{id:2,name:"Lesesaal 2",people:20,capacity:40,type:"Leses\xe4le"},{id:3,name:"Lesesaal 3",people:12,capacity:40,type:"Leses\xe4le"},{id:4,name:"Lesesaal 4",people:30,capacity:50,type:"Leses\xe4le"},{id:5,name:"Lesesaal 5",people:10,capacity:50,type:"Leses\xe4le"},{id:6,name:"Gruppenraum A",people:8,capacity:10,type:"Gruppenr\xe4ume"},{id:7,name:"Gruppenraum B",people:10,capacity:10,type:"Gruppenr\xe4ume"},{id:8,name:"Gruppenraum C",people:4,capacity:10,type:"Gruppenr\xe4ume"},{id:9,name:"Gruppenraum D",people:9,capacity:12,type:"Gruppenr\xe4ume"},{id:10,name:"Gruppenraum E",people:7,capacity:10,type:"Gruppenr\xe4ume"},{id:11,name:"Seitenbank 1",people:2,capacity:4,type:"Seitenb\xe4nke"},{id:12,name:"Seitenbank 2",people:3,capacity:4,type:"Seitenb\xe4nke"},{id:13,name:"Seitenbank 3",people:1,capacity:4,type:"Seitenb\xe4nke"},{id:14,name:"Seitenbank 4",people:4,capacity:4,type:"Seitenb\xe4nke"},{id:15,name:"Seitenbank 5",people:2,capacity:4,type:"Seitenb\xe4nke"}]}},e=>{e.O(0,[619,741,979,441,255,358],()=>e(e.s=138)),_N_E=e.O()}]);